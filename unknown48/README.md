# Unknown48时序数据回归预测项目

本项目旨在为Unknown48时序数据集构建回归模型，目标是达到测试集上的Pearson相关系数不低于0.9。该数据集是一个复杂的三维时序数据，需要运用深度学习和传统机器学习方法进行建模。

## 数据集概述

Unknown48是一个时序回归数据集，具有以下特点：
- **训练集**：800个样本，形状为(800, 48, 9) - 48个时间步长，每步9个特征
- **测试集**：200个样本，形状为(200, 48, 9)
- **目标变量**：连续值，范围[0.546879, 0.685809]，均值约0.631337
- **数据特性**：时序依赖性强，特征间相关性较弱，需要复杂的非线性建模

## 项目结构

```
unknown48/
├── data/                           # 数据目录
│   └── raw/                       # 原始数据文件
│       ├── x_48_train(1).npy     # 训练集输入 (800, 48, 9)
│       ├── y_48_train(1).npy     # 训练集标签 (800,)
│       ├── x_48_test(1).npy      # 测试集输入 (200, 48, 9)
│       └── y_48_test(1).npy      # 测试集标签 (200,)
├── data_analysis_results/          # 数据分析结果
├── models/                         # 训练好的模型保存目录
├── results/                        # 实验结果保存目录
├── visualizations/                 # 可视化结果目录
├── evaluation/                     # 模型评估结果
├── test_plots/                     # 测试图表目录
├── scripts/                        # 训练脚本目录
├── cnn_model.py                   # 一维CNN模型
├── cnn_model_2d.py                # 二维CNN模型
├── hybrid_model.py                # CNN+LSTM混合模型
├── hybrid_model_2d.py             # 二维混合模型
├── train_resnet_1d.py             # 一维ResNet模型
├── train_resnet_2d.py             # 二维ResNet模型
├── train_gbdt.py                  # 梯度提升树模型
├── train.py                       # 传统机器学习模型训练
├── data_analysis.py               # 数据分析脚本
├── 分析报告.md                     # 详细数据分析报告
├── requirements.txt               # 依赖包列表
└── README.md                      # 项目说明文档
```

## 核心方法

### 1. 深度学习方法

#### 一维卷积神经网络 (1D CNN)
- **适用场景**：时序特征提取
- **网络结构**：多层1D卷积 + 全连接层
- **特点**：能够捕捉局部时序模式

#### 二维卷积神经网络 (2D CNN)
- **数据处理**：将(48, 9)时序数据视为二维图像
- **网络结构**：2D卷积层 + 池化层 + 全连接层
- **特点**：同时考虑时间和特征维度的关系

#### ResNet残差网络
- **一维ResNet**：针对时序数据的残差连接
- **二维ResNet**：基于图像处理的残差网络
- **优势**：解决深层网络梯度消失问题

#### 混合模型 (CNN + LSTM)
- **架构**：CNN特征提取 + LSTM时序建模
- **优势**：结合卷积的局部特征提取和LSTM的长期依赖建模
- **变体**：一维和二维混合模型

### 2. 传统机器学习方法

#### 特征工程策略
- **统计特征**：对48个时间步提取均值、最大值、最小值、标准差
- **原始特征**：9个原始特征 → 36个统计特征
- **时序特征**：趋势、周期性、自相关性等

#### 梯度提升树 (GBDT)
- **XGBoost**：极端梯度提升
- **LightGBM**：轻量级梯度提升
- **CatBoost**：类别特征优化的梯度提升

#### 集成方法
- **随机森林**：基于决策树的集成
- **投票回归器**：多模型集成
- **堆叠回归器**：分层集成策略

## 环境设置

### 依赖安装

```bash
pip install -r requirements.txt
```

主要依赖包：
- numpy >= 1.20.0
- scipy >= 1.7.0
- scikit-learn >= 1.0.0
- matplotlib >= 3.4.0
- pandas >= 1.3.0
- joblib >= 1.0.0

### 深度学习框架

```bash
# PyTorch (推荐)
pip install torch torchvision

# TensorFlow (可选)
pip install tensorflow
```

## 使用方法

### 1. 数据分析

```bash
python unknown48/data_analysis.py
```

生成详细的数据分析报告，包括：
- 时序特征分析
- 特征相关性分析
- 目标变量分布分析
- 主成分分析

### 2. 深度学习模型训练

#### 一维CNN模型
```bash
python unknown48/cnn_model.py
```

#### 二维CNN模型
```bash
python unknown48/cnn_model_2d.py
```

#### ResNet模型
```bash
python unknown48/train_resnet_1d.py  # 一维ResNet
python unknown48/train_resnet_2d.py  # 二维ResNet
```

#### 混合模型
```bash
python unknown48/hybrid_model.py     # 一维混合模型
python unknown48/hybrid_model_2d.py  # 二维混合模型
```

### 3. 传统机器学习模型

#### 梯度提升树
```bash
python unknown48/train_gbdt.py
```

#### 多模型训练
```bash
python unknown48/train.py
```

## 评估指标

- **Pearson相关系数**：主要目标指标，要求 ≥ 0.9
- **均方误差 (MSE)**：衡量预测精度
- **平均绝对误差 (MAE)**：衡量预测偏差
- **决定系数 (R²)**：解释方差比例

## 数据分析发现

基于详细的数据分析（见`分析报告.md`），主要发现：

1. **时序特性**：数据具有明显的时序依赖关系
2. **特征相关性**：单个特征与目标变量相关性较弱（最高0.089）
3. **非线性关系**：需要复杂的非线性模型捕捉数据模式
4. **维度特点**：需要26个主成分解释95%方差，维度较高

## 建模策略

1. **时序建模**：优先使用LSTM、GRU等循环神经网络
2. **卷积特征提取**：使用CNN捕捉局部时序模式
3. **集成学习**：结合多种模型提高预测稳定性
4. **特征工程**：提取丰富的时序统计特征

## 实验结果

通过多种方法的对比实验：
- **深度学习模型**：在复杂时序模式识别上表现优异
- **传统方法**：在特征工程充分的情况下也能取得良好效果
- **混合策略**：结合CNN和LSTM的模型通常表现最佳

## 可视化输出

训练过程自动生成：
1. **训练曲线**：损失和相关系数变化
2. **预测散点图**：预测值vs真实值对比
3. **时序可视化**：原始数据时序模式展示
4. **特征重要性**：基于树模型的特征排序
5. **残差分析**：预测误差分布分析

所有结果按时间戳保存在相应的输出目录中。